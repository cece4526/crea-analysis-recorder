<!-- Modal HACCP -->
<div class="modal fade" id="haccpModal" tabindex="-1" aria-labelledby="haccpModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-md">
        <div class="modal-content">
            <div class="modal-header bg-primary-custom text-white">
                <h5 class="modal-title" id="haccpModalLabel">
                    <i class="fas fa-shield-alt me-2"></i>Contrôles COP et PIPO
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="text-center mb-3">
                    <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMzAiIGN5PSIzMCIgcj0iMjkiIGZpbGw9IiM5QkM1M0QiIHN0cm9rZT0iIzJENTAxNiIgc3Ryb2tlLXdpZHRoPSIyIi8+Cjx0ZXh0IHg9IjMwIiB5PSIyMCIgZm9udC1mYW1pbHk9IkFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjEwIiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+SEFDQ1A8L3RleHQ+Cjx0ZXh0IHg9IjMwIiB5PSI0MCIgZm9udC1mYW1pbHk9IkFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjgiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5BdXRvcmlzw6k8L3RleHQ+Cjwvc3ZnPgo=" alt="HACCP" class="mb-2">
                </div>

                <form id="haccpForm" method="POST" action="{{ path('haccp_create') }}">
                    <input type="hidden" id="haccp_of_id" name="of_id">
                    
                    <div class="row mb-4">
                        <div class="col-12 text-center">
                            <h6 class="fw-bold">Formulaire d'enregistrement HACCP</h6>
                        </div>
                    </div>

                    <!-- Contrôles des filtres -->
                    <div class="row mb-3">
                        <div class="col-4 text-center">
                            <label class="form-label fw-bold small">Contrôles des filtres en début de production</label>
                            <div class="mt-3">
                                <div class="form-check d-flex justify-content-center align-items-center">
                                    <input type="checkbox" class="form-check-input me-2" id="filtre_pasteurisateur_resultat" name="filtre_pasteurisateur_resultat" value="1" style="transform: scale(1.5);">
                                    <label for="filtre_pasteurisateur_resultat" class="form-check-label fw-bold text-success">OK</label>
                                </div>
                            </div>
                            <div class="mt-2">
                                <label for="initialProduction" class="form-label small">Initiales</label>
                                <input type="text" class="form-control form-control-sm text-center" id="initialProduction" name="initialProduction" maxlength="5" placeholder="ABC">
                            </div>
                        </div>
                        
                        <div class="col-4 text-center">
                            <label class="form-label fw-bold small">COP IT Thermique<br>Valeur critique : 110</label>
                            <div class="mt-2">
                                <label for="temperature_cible" class="form-label small">Température cible</label>
                                <input type="number" step="1" class="form-control form-control-sm text-center" id="temperature_cible" name="temperature_cible" placeholder="110" value="110">
                            </div>
                            <div class="mt-2">
                                <label for="temperature_indique" class="form-label small">Température indiquée</label>
                                <input type="number" step="1" class="form-control form-control-sm text-center" id="temperature_indique" name="temperature_indique" placeholder="110">
                            </div>
                            <div class="mt-2">
                                <label for="initialTEMP" class="form-label small">Initiales</label>
                                <input type="text" class="form-control form-control-sm text-center" id="initialTEMP" name="initialTEMP" maxlength="5" placeholder="ABC">
                            </div>
                        </div>
                        
                        <div class="col-4 text-center">
                            <label class="form-label fw-bold small">Contrôle des filtres avant NEP</label>
                            <div class="mt-3">
                                <div class="form-check d-flex justify-content-center align-items-center">
                                    <input type="checkbox" class="form-check-input me-2" id="filtre_nep_resultat" name="filtre_nep_resultat" value="1" style="transform: scale(1.5);">
                                    <label for="filtre_nep_resultat" class="form-check-label fw-bold text-success">OK</label>
                                </div>
                            </div>
                            <div class="mt-2">
                                <label for="initialNEP" class="form-label small">Initiales</label>
                                <input type="text" class="form-control form-control-sm text-center" id="initialNEP" name="initialNEP" maxlength="5" placeholder="ABC">
                            </div>
                        </div>
                    </div>

                    <!-- Indicateurs visuels avec status -->
                    <div class="row mb-3">
                        <div class="col-4 text-center">
                            <div id="status_filtre_pasteurisateur" class="bg-secondary rounded p-2" style="height: 20px;"></div>
                            <small class="text-muted">État du contrôle</small>
                        </div>
                        <div class="col-4 text-center">
                            <div id="status_temperature" class="bg-secondary rounded p-2" style="height: 20px;"></div>
                            <small class="text-muted">État du contrôle</small>
                        </div>
                        <div class="col-4 text-center">
                            <div id="status_filtre_nep" class="bg-secondary rounded p-2" style="height: 20px;"></div>
                            <small class="text-muted">État du contrôle</small>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer justify-content-center">
                <button type="submit" form="haccpForm" class="btn btn-success me-3 px-4">
                    <i class="fas fa-check me-1"></i>Valider
                </button>
                <button type="button" class="btn btn-danger px-4" data-bs-dismiss="modal">
                    <i class="fas fa-times me-1"></i>Quitter
                </button>
            </div>
        </div>
    </div>
</div>

<style>
.modal-header.bg-primary-custom {
    background-color: var(--primary-green) !important;
}

.btn-primary-custom {
    background-color: var(--primary-green);
    border-color: var(--primary-green);
    color: white;
}

.btn-primary-custom:hover {
    background-color: var(--dark-green);
    border-color: var(--dark-green);
}

.alert-info {
    background-color: rgba(155, 197, 61, 0.1);
    border-color: var(--primary-green);
    color: var(--dark-green);
}

.form-label {
    color: var(--dark-green);
    font-weight: 500;
}

.form-control:focus {
    border-color: var(--primary-green);
    box-shadow: 0 0 0 0.2rem rgba(155, 197, 61, 0.25);
}

.form-select:focus {
    border-color: var(--primary-green);
    box-shadow: 0 0 0 0.2rem rgba(155, 197, 61, 0.25);
}
</style>

<!-- Le JavaScript est maintenant géré dans le template principal -->
